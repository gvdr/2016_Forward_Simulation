branching.times.with.extinct                package:unknown                R Documentation

	Cálculo dos tempos de especiação de uma filogenia com espécies extintas

Descrição:

     Essa função computa os tempos especiação de uma filogenia com espécies viventes e extintas. Isso significa, a função retornará um vetor com a distancia entre cada nó e o tempo presente.  

Usage:

     branching.times.with.extinct(phy)

Arguments:

	phy			um objeto no formato phylo

Valores:

     Um vetor com os valores entre cada nó e o tempo presente. Se o objeto phy possui um elemento node.label este será usado para nomear o vetor retornado. Caso contrário os nomes são tirados do elemento edge do objeto phy.

Observações:
	
	A função branching.times.with.extinct é uma modificação da função branching.times do pacote ape.
	A seguir está o código da função original, a linha indicada por "ERRO!" corresponde ao trecho da função que foi alterada.
	
# branching.times<-function (phy) 
# {
#     if (!inherits(phy, "phylo")) 
#         stop("object \"phy\" is not of class \"phylo\"")
#     n <- length(phy$tip.label)
#     N <- dim(phy$edge)[1]
#     xx <- numeric(phy$Nnode)
#     interns <- which(phy$edge[, 2] > n)
#     for (i in interns) xx[phy$edge[i, 2] - n] <- xx[phy$edge[i,1] - n] + phy$edge.length[i]
#     depth <- xx[phy$edge[N, 1] - n] + phy$edge.length[N]      #####ERRO!
#     xx <- depth - xx
#     names(xx) <- if (is.null(phy$node.label)) 
#         (n + 1):(n + phy$Nnode)
#     else phy$node.label
#     xx
# }

	A linha indicada por erro tem como objetivo calcular o tempo total da filogenia. No entanto quando a filogenia apresenta espécies extintas esse calculo deve ser feito de outra maneira.
	A solução proposta na função branching.times.with.extinct leva em consideração o tempo de todos os táxons terminais em relação ao nó mais basal da árvore. E o tempo usado é o valor máximo calculado.
	
Author(s):

     Emmanuel Paradis - autor da função original branching.times
     Daniel Varajão de Latorre - autor das modificações presentes


Examples:

library(ape)
phy<-rlineage(1, 0.6, 2)
phy
par(mfrow=c(2,1))
plot(phy)
axisPhylo()
branc<-branching.times.with.extinct(phy)
plot(phy)
axisPhylo()
for(i in 1:length(branc))
    lines(x=c(2-branc[i], 2-branc[i]), y=c(-1000, 1000), col="red")